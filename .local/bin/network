
case $1 in
  monitor)
    dbus-monitor --system interface="org.freedesktop.NetworkManager" | while read -r; do
      IFS=: read -r ssid strength_index < <(
        nmcli -t -f ACTIVE,SSID,SIGNAL dev wifi \
          | awk -F: '$1=="yes"{ print $2":"int(($3 - 1)/25); exit }'
      )

      [[ -z $ssid ]] && ssid="Disconnected"

      eww update wifi-ssid="$ssid"
      eww update wifi-strength-index=$strength_index
    done
  ;;
esac
